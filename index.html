<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PontoView • Clima</title>
  <style>
    :root{
      --bgA:#1d4c7b; --bgB:#0b1b2b;
      --card:#ffffff; --line:#e7eef7; --chip:#f3f6fb;
      --muted:#6b7788; --ink:#0e1b2a;
      --topA:#163d63; --topB:#2c6aa3;
      --radius:22px; --shadow:0 10px 30px rgba(0,0,0,.25);
      --t-title: clamp(20px, 1.4vw, 28px);
      --t-sub:   clamp(12px, 0.9vw, 16px);
      --t-clock: clamp(34px, 2.6vw, 54px);
      --t-body:  clamp(14px, 1.05vw, 18px);
      --pad: clamp(16px, 1.3vw, 22px);
      --gap: clamp(14px, 1.2vw, 20px);

      /* Conteúdo (moderado — não gigante) */
      --t-temp: clamp(72px, 6vw, 120px);
      --t-desc: clamp(14px, 1.1vw, 18px);
      --t-mval: clamp(18px, 1.35vw, 24px);
      --t-day:  clamp(14px, 1.05vw, 18px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      background: radial-gradient(1200px 700px at 50% 0%, var(--bgA) 0%, var(--bgB) 60%);
    }
    .frame{min-height:100%; padding:clamp(14px,1.2vw,22px); display:flex; justify-content:center; align-items:stretch;}
    .card{
      width:min(1920px,100%);
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
      display:flex; flex-direction:column;
    }
    .topbar{
      background: linear-gradient(180deg, var(--topB), var(--topA));
      color:#fff;
      padding:var(--pad);
      display:flex; justify-content:space-between; align-items:center;
      gap:var(--gap);
    }
    .left{display:flex; align-items:center; gap:var(--gap); min-width:45%;}
    .badge{
      width:clamp(44px,3.2vw,60px); height:clamp(44px,3.2vw,60px);
      border-radius:16px;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.22);
      display:grid; place-items:center; flex:0 0 auto;
    }
    .badge svg{width:60%; height:60%; opacity:.95}
    .titles{display:flex; flex-direction:column; gap:6px; line-height:1.05; min-width:0;}
    .titles h1{
      margin:0; font-size:var(--t-title); font-weight:900;
      letter-spacing:.08em; text-transform:uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .titles .sub{
      font-size:var(--t-sub); font-weight:800; letter-spacing:.12em;
      text-transform:uppercase; opacity:.9;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .right{text-align:right; display:flex; flex-direction:column; gap:6px; min-width:30%;}
    .clockTop{font-size:var(--t-clock); font-weight:900; line-height:1;}
    .updated{font-size:var(--t-sub); font-weight:800; letter-spacing:.10em; text-transform:uppercase; opacity:.9;}
    .subbar{
      background:var(--chip);
      border-bottom:1px solid var(--line);
      padding:calc(var(--pad)*.6) var(--pad);
      display:flex; justify-content:space-between; align-items:center;
      gap:var(--gap);
      font-size:var(--t-sub);
      font-weight:900; letter-spacing:.12em; text-transform:uppercase;
      color:#1c2c41;
    }
    main{flex:1 1 auto; padding:var(--pad);}
    .grid-2{
      display:grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: var(--gap);
      align-items:start;
    }
    @media (max-aspect-ratio: 4/3){ .grid-2{grid-template-columns:1fr;} }

    /* Atual */
    .now{
      display:grid;
      grid-template-columns:auto 1fr;
      gap: var(--gap);
      align-items:center;
      padding: 8px;
    }
    .bigIcon{
      width: clamp(84px, 6vw, 110px);
      height: clamp(84px, 6vw, 110px);
      color:#7ea7cf;
      display:grid; place-items:center;
    }
    .bigIcon svg{width:100%; height:100%}
    .temp{
      font-size: var(--t-temp);
      font-weight: 300;
      letter-spacing: -0.03em;
      line-height: 0.95;
    }
    .desc{
      font-size: var(--t-desc);
      font-weight: 900;
      letter-spacing: .12em;
      text-transform: uppercase;
      color:#2a3a50;
      margin-top: 6px;
    }

    /* Métricas */
    .metrics{
      margin-top: var(--gap);
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--gap);
    }
    .metric{
      background:#f6f9fe;
      border:1px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      min-height: 78px;
    }
    .mleft{display:flex; align-items:center; gap:12px; min-width:0;}
    .micon{
      width: 46px; height: 46px;
      border-radius: 14px;
      background:#fff;
      border:1px solid var(--line);
      display:grid; place-items:center;
      flex:0 0 auto;
      color:#0f2f57;
    }
    .micon svg{width:56%; height:56%}
    .mlabel{
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform: uppercase;
      color:#3c4b60;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .mvalue{
      font-size: var(--t-mval);
      font-weight: 900;
      white-space:nowrap;
    }

    /* Próximos dias */
    .list{display:flex; flex-direction:column; gap: var(--gap);}
    .dayRow{
      background:#f6f9fe;
      border:1px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      display:grid;
      grid-template-columns: auto auto 1fr auto;
      align-items:center;
      gap: var(--gap);
      min-height: 84px;
    }
    .dow{
      width: 62px;
      font-size: var(--t-day);
      font-weight: 900;
      letter-spacing:.14em;
      text-transform: uppercase;
      color:#1a2a40;
    }
    .dicon{
      width: 54px; height: 54px;
      border-radius: 16px;
      background:#fff;
      border:1px solid var(--line);
      display:grid; place-items:center;
      color:#7ea7cf;
    }
    .dicon svg{width:64%; height:64%}
    .dtext{min-width:0; display:flex; flex-direction:column; gap:6px;}
    .dtitle{
      font-size: var(--t-body);
      font-weight: 900;
      letter-spacing:.06em;
      text-transform: uppercase;
      color:#23344a;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .drain{
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.12em;
      text-transform: uppercase;
      color:#3b4b62;
      opacity:.9;
    }
    .dtemps{
      font-size: var(--t-mval);
      font-weight: 900;
      white-space:nowrap;
    }
  </style>
</head>

<body>
  <div class="frame">
    <div class="card" id="panel"
      data-title="PREVISÃO DO TEMPO"
      data-subtitle="COLATINA - ES"
      data-subleft="CLIMA ATUAL + PRÓXIMOS DIAS"
      data-subright="FONTE • OPEN-METEO">

      <header class="topbar">
        <div class="left">
          <div class="badge" aria-hidden="true">
            <!-- nuvem -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 17.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 10.2 3.8 3.8 0 0 0 7 17.5h13z"/>
            </svg>
          </div>
          <div class="titles">
            <h1 id="title"></h1>
            <div class="sub" id="subtitle"></div>
          </div>
        </div>
        <div class="right">
          <div class="clockTop" id="clockTop">--:--</div>
          <div class="updated" id="updated">ATUALIZADO • --:--</div>
        </div>
      </header>

      <div class="subbar">
        <div id="subLeft"></div>
        <div id="subRight"></div>
      </div>

      <main>
        <div class="grid-2">
          <section>
            <div class="now">
              <div class="bigIcon" id="nowIcon" aria-hidden="true"></div>
              <div>
                <div class="temp" id="tempNow">--°</div>
                <div class="desc" id="descNow">CARREGANDO...</div>
              </div>
            </div>

            <div class="metrics">
              <div class="metric">
                <div class="mleft">
                  <div class="micon" aria-hidden="true">
                    <!-- vento -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M3 8h10a2 2 0 1 0-2-2"/>
                      <path d="M3 12h14a2 2 0 1 1-2 2"/>
                      <path d="M3 16h8a2 2 0 1 0 2-2"/>
                    </svg>
                  </div>
                  <div class="mlabel">VENTO</div>
                </div>
                <div class="mvalue" id="wind">-- km/h</div>
              </div>

              <div class="metric">
                <div class="mleft">
                  <div class="micon" aria-hidden="true">
                    <!-- umidade -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M12 2s6 7 6 12a6 6 0 0 1-12 0c0-5 6-12 6-12z"/>
                    </svg>
                  </div>
                  <div class="mlabel">UMIDADE</div>
                </div>
                <div class="mvalue" id="humidity">--%</div>
              </div>

              <div class="metric">
                <div class="mleft">
                  <div class="micon" aria-hidden="true">
                    <!-- sensação -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M14 14.76V5a2 2 0 0 0-4 0v9.76a4 4 0 1 0 4 0z"/>
                    </svg>
                  </div>
                  <div class="mlabel">SENSAÇÃO</div>
                </div>
                <div class="mvalue" id="feels">--°C</div>
              </div>

              <div class="metric">
                <div class="mleft">
                  <div class="micon" aria-hidden="true">
                    <!-- chuva -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M16 13a4 4 0 0 0-8 0c0 3 4 7 4 7s4-4 4-7z"/>
                    </svg>
                  </div>
                  <div class="mlabel">CHUVA</div>
                </div>
                <div class="mvalue" id="rain">-- mm</div>
              </div>
            </div>
          </section>

          <section>
            <div class="list" id="forecastList"></div>
          </section>
        </div>
      </main>
    </div>
  </div>

  <script>
    // ===== CONFIG =====
    // Troque para sua cidade fixa (recomendado para TV)
    const CITY = { name: "Colatina - ES", lat: -19.538, lon: -40.626 };

    // ===== HEADER DATASET =====
    const panel = document.getElementById("panel");
    document.getElementById("title").textContent = panel.dataset.title || "";
    document.getElementById("subtitle").textContent = panel.dataset.subtitle || CITY.name;
    document.getElementById("subLeft").textContent = panel.dataset.subleft || "";
    document.getElementById("subRight").textContent = panel.dataset.subright || "";

    function hhmm(d=new Date()){
      return String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0");
    }
    function tickClock(){
      const t = hhmm();
      document.getElementById("clockTop").textContent = t;
      document.getElementById("updated").textContent = `ATUALIZADO • ${t}`;
    }
    tickClock();
    setInterval(tickClock, 1000*10);

    // ===== ICONES =====
    function svgCloud(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 17.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 10.2 3.8 3.8 0 0 0 7 17.5h13z"/>
      </svg>`; }
    function svgSun(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"></path>
      </svg>`; }
    function svgRain(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h13z"/>
        <path d="M8 19l-1 2"></path>
        <path d="M12 19l-1 2"></path>
        <path d="M16 19l-1 2"></path>
      </svg>`; }
    function svgStorm(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h9"/>
        <path d="M13 14l-2 4h3l-2 4"></path>
      </svg>`; }
    function svgPartly(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="8" cy="8" r="3"></circle>
        <path d="M8 2v1M8 13v1M2 8h1M13 8h1M3.5 3.5l.7.7M11.8 11.8l.7.7M3.5 12.5l.7-.7M11.8 4.2l.7-.7"></path>
        <path d="M20 17.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 8.3 10.1 3.8 3.8 0 0 0 9 17.5h11z"/>
      </svg>`; }

    function codeToMeta(code){
      if (code === 0) return { icon: svgSun(), text: "Ensolarado" };
      if (code === 1 || code === 2) return { icon: svgPartly(), text: "Parcialmente nublado" };
      if (code === 3) return { icon: svgCloud(), text: "Nublado" };
      if ([45,48].includes(code)) return { icon: svgCloud(), text: "Neblina" };
      if ([51,53,55,61,63,65,80,81,82].includes(code)) return { icon: svgRain(), text: "Chuva" };
      if ([95,96,99].includes(code)) return { icon: svgStorm(), text: "Tempestade" };
      if ([71,73,75,77,85,86].includes(code)) return { icon: svgCloud(), text: "Neve" };
      return { icon: svgCloud(), text: "Tempo" };
    }
    function dowPT(dateStr){
      const d = new Date(dateStr + "T12:00:00");
      const map = ["DOM","SEG","TER","QUA","QUI","SEX","SÁB"];
      return map[d.getDay()];
    }

    async function loadWeather(){
      const url = new URL("https://api.open-meteo.com/v1/forecast");
      url.searchParams.set("latitude", CITY.lat);
      url.searchParams.set("longitude", CITY.lon);
      url.searchParams.set("timezone", "America/Sao_Paulo");
      url.searchParams.set("current", "temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m");
      url.searchParams.set("daily", "weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max");
      url.searchParams.set("forecast_days", "5");

      const res = await fetch(url.toString(), { cache:"no-store" });
      if(!res.ok) throw new Error("Falha ao carregar clima");
      const data = await res.json();

      const cur = data.current;
      const now = codeToMeta(cur.weather_code);

      document.getElementById("tempNow").textContent = `${Math.round(cur.temperature_2m)}°`;
      document.getElementById("descNow").textContent = now.text.toUpperCase();
      document.getElementById("nowIcon").innerHTML = now.icon;

      document.getElementById("wind").textContent = `${Math.round(cur.wind_speed_10m)} km/h`;
      document.getElementById("humidity").textContent = `${Math.round(cur.relative_humidity_2m)}%`;
      document.getElementById("feels").textContent = `${Math.round(cur.apparent_temperature)}°C`;
      document.getElementById("rain").textContent = `${Number(cur.precipitation).toFixed(1)} mm`;

      // próximos dias (pula hoje)
      const list = document.getElementById("forecastList");
      list.innerHTML = "";
      const times = data.daily.time;

      for(let i=1; i<times.length; i++){
        const date = times[i];
        const meta = codeToMeta(data.daily.weather_code[i]);
        const max = Math.round(data.daily.temperature_2m_max[i]);
        const min = Math.round(data.daily.temperature_2m_min[i]);
        const pop = data.daily.precipitation_probability_max[i] ?? 0;

        const row = document.createElement("div");
        row.className = "dayRow";
        row.innerHTML = `
          <div class="dow">${dowPT(date)}</div>
          <div class="dicon" aria-hidden="true">${meta.icon}</div>
          <div class="dtext">
            <div class="dtitle">${meta.text.toUpperCase()}</div>
            <div class="drain">CHUVA ${pop}%</div>
          </div>
          <div class="dtemps">${max}° / ${min}°</div>
        `;
        list.appendChild(row);
      }
    }

    loadWeather().catch(err=>{
      document.getElementById("descNow").textContent = "SEM CONEXÃO";
      console.error(err);
    });
    setInterval(()=>loadWeather().catch(()=>{}), 1000*60*20);
  </script>
</body>
</html>
