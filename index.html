<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PontoView • Previsão do Tempo</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600;800;900&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --bg0:#081423;
      --bg1:#0a2232;

      --card:#ffffff;
      --line:#e7eef7;
      --chip:#f3f6fb;
      --muted:#6b7788;
      --ink:#0e1b2a;

      --topA:#0b2a44;
      --topB:#2c6aa3;
      --topC:#0f3d63;

      --radius:22px;
      --shadow:0 12px 36px rgba(0,0,0,.28);

      --t-title: clamp(20px, 1.55vw, 34px);
      --t-sub:   clamp(12px, 0.95vw, 16px);
      --t-clock: clamp(34px, 3.05vw, 64px);

      --pad: clamp(16px, 1.4vw, 26px);
      --gap: clamp(14px, 1.2vw, 20px);

      --panelSoft:#f6f9fe;

      --anim: 520ms;
      --ease: cubic-bezier(.2,.8,.2,1);

      --footerH: clamp(52px, 6vh, 82px);
      --safe: clamp(14px, 2.2vw, 32px);

      /* ALERT forte */
      --warnBg:#fff0c2;
      --warnInk:#5a3a00;
      --warnLine:#f2c66a;
      --warnHot:#f59e0b;
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 900px at 25% 10%, rgba(87,184,231,.22) 0%, rgba(10,46,62,0) 60%),
        radial-gradient(900px 700px at 75% 80%, rgba(52,198,208,.14) 0%, rgba(6,18,24,0) 65%),
        radial-gradient(1400px 1100px at 50% 55%, var(--bg1) 0%, var(--bg0) 62%, #040a0f 100%);
      overflow:hidden;
    }

    .pvFrame{
      width:100vw;
      height:100vh;
      padding: var(--safe);
      display:flex;
    }

    .pvCard{
      width:100%;
      height:100%;
      background:var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:0;
      opacity:0;
      transform: translateY(12px);
      animation: pvIn 900ms cubic-bezier(.22,1,.36,1) forwards;
    }
    @keyframes pvIn{to{opacity:1; transform:translateY(0)}}

    /* ===== HEADER ===== */
    .pvHeader{
      position:relative;
      background: linear-gradient(180deg, var(--topB) 0%, var(--topC) 42%, var(--topA) 100%);
      color:#fff;
      padding: calc(var(--pad) * 1.05);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:var(--gap);
      flex:0 0 auto;
      min-width:0;
      border-bottom: 1px solid rgba(255,255,255,.12);
      box-shadow: inset 0 -1px 0 rgba(255,255,255,.18);
    }
    .pvHeader::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(900px 120px at 50% 0%, rgba(255,255,255,.22), rgba(255,255,255,0) 65%),
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,0) 42%);
      opacity:.95;
    }
    .pvHeader::after{
      content:"";
      position:absolute;
      inset:10px;
      border-radius: calc(var(--radius) - 10px);
      border: 1px solid rgba(255,255,255,.10);
      pointer-events:none;
      opacity:.45;
    }

    .pvLeft, .pvRight{position:relative; z-index:1;}
    .pvLeft{
      display:flex;
      align-items:center;
      gap:var(--gap);
      min-width:0;
      flex:1 1 auto;
    }
    .pvBadge{
      width:clamp(46px,3.4vw,64px);
      height:clamp(46px,3.4vw,64px);
      border-radius: 16px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.22);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.18);
      display:grid;
      place-items:center;
      flex:0 0 auto;
    }
    .pvBadge svg{width:60%; height:60%; opacity:.95}

    .pvTitles{
      display:flex;
      flex-direction:column;
      gap:6px;
      line-height:1.05;
      min-width:0;
    }
    .pvTitle{
      margin:0;
      font-size:var(--t-title);
      font-weight:900;
      letter-spacing:.06em;
      text-transform:uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .pvSubtitle{
      font-size:var(--t-sub);
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:.92;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .pvRight{
      text-align:right;
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:max-content;
      align-items:flex-end;
      padding-left: 10px;
      white-space:nowrap;
    }
    .pvClock{
      font-size:var(--t-clock);
      font-weight:900;
      line-height:1;
      letter-spacing:.02em;
      font-variant-numeric: tabular-nums;
    }

    /* ===== SUBBAR ===== */
    .pvSubbar{
      background:var(--chip);
      border-bottom:1px solid var(--line);
      padding:calc(var(--pad)*.62) var(--pad);
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:center;
      gap:var(--gap);
      font-size:var(--t-sub);
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:#1c2c41;
      flex:0 0 auto;
      min-width:0;
    }
    .pvSubLeft{
      justify-self:start;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .pvSubRight{
      justify-self:end;
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:12px;
      min-width:0;
      white-space:nowrap;
    }
    .sourceTag{
      font-size: 11px;
      font-weight: 900;
      letter-spacing:.12em;
      text-transform: uppercase;
      color:#3b4b62;
      opacity:.95;
      white-space:nowrap;
      padding:8px 12px;
      border-radius:999px;
      background:#fff;
      border:1px solid #e7e9ee;
      box-shadow: 0 8px 18px rgba(0,0,0,.04);
    }

    /* ALERT */
    .alertPill{
      display:none;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      background: var(--warnBg);
      border:2px solid var(--warnLine);
      color: var(--warnInk);
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.10em;
      text-transform:uppercase;
      white-space:nowrap;
      box-shadow:
        0 10px 24px rgba(245,158,11,.18),
        0 0 0 0 rgba(245,158,11,.35);
      animation: alertGlow 1.2s var(--ease) infinite;
    }
    .alertPill.show{display:inline-flex;}
    .alertPill svg{width:18px; height:18px; flex:0 0 auto;}
    .alertPulse{
      width:10px; height:10px; border-radius:999px;
      background:var(--warnHot);
      box-shadow: 0 0 0 0 rgba(245,158,11,.45);
      animation: alertPulse 1.2s var(--ease) infinite;
    }
    @keyframes alertPulse{
      0%{box-shadow:0 0 0 0 rgba(245,158,11,.45)}
      70%{box-shadow:0 0 0 14px rgba(245,158,11,0)}
      100%{box-shadow:0 0 0 0 rgba(245,158,11,0)}
    }
    @keyframes alertGlow{
      0%,100%{box-shadow: 0 10px 24px rgba(245,158,11,.18), 0 0 0 0 rgba(245,158,11,.25)}
      50%{box-shadow: 0 14px 30px rgba(245,158,11,.26), 0 0 0 6px rgba(245,158,11,.08)}
    }

    /* ===== MAIN ===== */
    .pvMain{
      flex:1 1 auto;
      min-height:0;
      padding:var(--pad);
      display:flex;
      overflow:hidden;
    }
    .layout{
      width:100%;
      display:grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: var(--gap);
      align-items: stretch;
      min-height:0;
    }
    @media (max-aspect-ratio: 4/3){
      .layout{grid-template-columns:1fr;}
    }

    /* ===== HOJE (ESQUERDA) ===== */
    .todayCard{
      border:1px solid var(--line);
      border-radius: 20px;
      background:#fff;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:0;
    }
    .todayHead{
      padding: 18px 18px 10px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      min-width:0;
      flex:0 0 auto;
    }
    .city{
      font-size: 18px;
      font-weight: 900;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:#1a2a40;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .todayCenter{
      padding: 8px 18px 0;
      flex:1 1 auto;
      min-height:0;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .todayWrap{
      width:100%;
      max-width: 780px;
      display:grid;
      grid-template-columns: clamp(90px, 9vw, 150px) 1fr;
      align-items:center;
      gap: clamp(14px, 1.6vw, 22px);
    }
    .todayIcon{
      width: clamp(90px, 9vw, 150px);
      height: clamp(90px, 9vw, 150px);
      display:grid;
      place-items:center;
      color:#0f3d63;
      opacity:.95;
    }
    .todayIcon svg{width:100%; height:100%}

    .tempBlock{min-width:0}
    .tempBig{
      font-size: clamp(78px, 7.2vw, 150px);
      font-weight: 900;
      letter-spacing:-0.03em;
      line-height: .92;
      white-space:nowrap;
    }
    .tempBig small{font-size:.42em; font-weight: 900; opacity:.92}
    .condLine{
      margin-top: 10px;
      font-size: 14px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#2a3a50;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .todayBottom{
      padding: 14px 18px 16px;
      border-top:1px solid var(--line);
      background:#fff;
      flex:0 0 auto;
    }

    .metricsRow{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      align-items:stretch;
    }
    @media (max-width: 1100px){
      .metricsRow{grid-template-columns: repeat(2, 1fr);}
    }
    @media (max-width: 680px){
      .metricsRow{grid-template-columns: 1fr;}
    }

    .mCard{
      background:#f1f3f5;
      border:1px solid #eceff3;
      border-radius: 14px;
      padding: 12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      min-width:0;
    }
    .mLeft{display:flex; align-items:center; gap:10px; min-width:0;}
    .mIcon{
      width:34px; height:34px;
      border-radius: 12px;
      background:#fff;
      border:1px solid #e7e9ee;
      display:grid; place-items:center;
      color:#1a2a40;
      opacity:.9;
      flex:0 0 auto;
    }
    .mIcon svg{width:62%; height:62%}
    .mLabel{
      font-size: 11px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#3b4b62;
      white-space:nowrap;
    }
    .mVal{
      font-size: 18px;
      font-weight: 900;
      white-space:nowrap;
      color:#0e1b2a;
    }

    /* ===== DIREITA (ALTERNÂNCIA) ===== */
    .side{
      border:1px solid var(--line);
      border-radius: 20px;
      background:#fff;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:0;
    }
    .sideHeader{
      padding: 14px 16px;
      background: var(--panelSoft);
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex:0 0 auto;
    }
    .sideHeader .label{
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform: uppercase;
      color:#3b4b62;
      white-space:nowrap;
      min-width:0;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .toggleDots{display:flex; gap:8px; align-items:center;}
    .tdot{width:10px; height:10px; border-radius:999px; background:#c9d7ea; transition: all 420ms var(--ease);}
    .tdot.active{background:#2d76b9; width:22px;}

    .slot{
      position:relative;
      flex:1 1 auto;
      padding: 16px;
      min-height:0;
      background:#fff;
      overflow:hidden;
    }

    /* transição discreta (fade + slide leve) */
    .view{
      position:absolute;
      inset: 16px;
      opacity:0;
      transform: translateY(10px);
      pointer-events:none;
      transition: opacity var(--anim) var(--ease), transform var(--anim) var(--ease);
      display:flex;
      flex-direction:column;
      gap: 12px;
      min-height:0;
    }
    .view.active{
      opacity:1;
      transform: translateY(0);
      pointer-events:auto;
    }

    /* ===== Próximos dias ===== */
    .forecastList{
      display:flex;
      flex-direction:column;
      gap: 12px;
      min-height:0;
      overflow:auto;
      overscroll-behavior: contain;
      scrollbar-width: none;
    }
    .forecastList::-webkit-scrollbar{ width:0; height:0; }

    .fRow{
      background:#f1f3f5;
      border:1px solid #eceff3;
      border-radius: 14px;
      padding: 12px;
      display:grid;
      grid-template-columns: 56px 44px 1fr auto;
      align-items:center;
      gap: 12px;
      min-width:0;
    }
    .fDow{
      font-size: 14px;
      font-weight: 900;
      letter-spacing:.14em;
      text-transform: uppercase;
      color:#1a2a40;
      white-space:nowrap;
    }
    .fIcon{
      width:44px; height:44px;
      border-radius: 14px;
      background:#fff;
      border:1px solid #e7e9ee;
      display:grid;
      place-items:center;
      color:#0f3d63;
      opacity:.95;
      flex:0 0 auto;
    }
    .fIcon svg{width:70%; height:70%}
    .fMid{min-width:0; display:flex; flex-direction:column; gap:6px;}
    .fBadge{
      display:inline-flex;
      align-items:center;
      padding: 8px 12px;
      border-radius:999px;
      background:#fff;
      border:1px solid #e7e9ee;
      width: fit-content;
      max-width: 100%;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.08em;
      text-transform: uppercase;
      color:#23344a;
    }
    .fSub{
      font-size: 11px;
      font-weight: 900;
      letter-spacing:.12em;
      text-transform: uppercase;
      color:#3b4b62;
      opacity:.92;
      white-space:nowrap;
    }
    .fTemps{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:10px;
      white-space:nowrap;
      font-weight: 900;
    }
    .pill{
      position: relative;
      padding: 10px 12px 8px;
      min-width: 52px;
      border-radius: 999px;
      background:#fff;
      border:1px solid #e7e9ee;
      font-size: 12px;
      font-weight: 900;
      color:#0e1b2a;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .pillTag{
      position:absolute;
      top:5px;
      left:50%;
      transform:translateX(-50%);
      font-size: 9px;
      font-weight: 900;
      letter-spacing: .14em;
      text-transform: uppercase;
      opacity: .55;
      line-height: 1;
      pointer-events:none;
    }
    .pillTemp{
      display:block;
      margin-top: 10px;
      font-size: 12px;
      font-weight: 900;
    }

    /* ===== Detalhes de HOJE (view B) ===== */
    .detailCard{
      border:1px solid #eef2f7;
      border-radius: 16px;
      padding: 14px;
      background:#fff;
      display:flex;
      flex-direction:column;
      gap: 12px;
      min-height:0;
    }
    .bigMinMax{
      display:flex;
      gap: 18px;
      align-items:flex-end;
      justify-content:flex-start;
      padding: 6px 2px 4px;
      flex-wrap:wrap;
    }
    .mmBlock{display:flex; align-items:baseline; gap:10px;}
    .mmNum{
      font-size: clamp(46px, 3.6vw, 64px);
      font-weight: 900;
      letter-spacing:-0.02em;
      line-height:1;
      color:#0e1b2a;
      white-space:nowrap;
    }
    .mmLbl{
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.12em;
      text-transform: uppercase;
      color:#7a8697;
      white-space:nowrap;
    }
    .detailPills{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .dPill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      background:#fff;
      border:1px solid #e7e9ee;
      box-shadow: 0 8px 18px rgba(0,0,0,.04);
      font-size: 12px;
      font-weight: 900;
      letter-spacing:.08em;
      text-transform: uppercase;
      color:#23344a;
      white-space:nowrap;
    }
    .dPill svg{width:16px;height:16px;opacity:.9}

    /* ===== FOOTER ===== */
    .pvFooter{
      flex:0 0 auto;
      height: var(--footerH);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 10px var(--pad);
      border-top:1px solid var(--line);
      background: transparent;
      gap: 12px;
      min-width:0;
    }
    .pvFooterUpdate{
      font-size: 11px;
      font-weight: 900;
      letter-spacing:.12em;
      text-transform: uppercase;
      color:#3b4b62;
      opacity:.95;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .pvLogo{
      height: clamp(16px, 2.4vh, 22px);
      width:auto;
      display:block;
      opacity:.90;
    }

    /* ===== ÍCONE HOJE animado ===== */
    .animFloat{
      animation: floaty 2.8s var(--ease) infinite;
      transform-origin: 50% 50%;
    }
    @keyframes floaty{
      0%,100%{transform: translateY(0)}
      50%{transform: translateY(-6px)}
    }
    .animRainDrop{animation: drop 1.2s linear infinite;}
    @keyframes drop{
      0%{transform: translateY(-2px); opacity:.2}
      35%{opacity:1}
      100%{transform: translateY(10px); opacity:0}
    }
    .animLightning{
      animation: flash 1.1s var(--ease) infinite;
      transform-origin: 50% 50%;
    }
    @keyframes flash{
      0%,60%,100%{opacity:1; transform: scale(1)}
      30%{opacity:.2; transform: scale(.98)}
    }

    /* ===== ANIMAÇÃO ÍCONE SENSAÇÃO TÉRMICA (apenas icFeel) ===== */
    #icFeel{
      position: relative;
      overflow: hidden; /* mantém o brilho dentro do badge do ícone */
    }
    #icFeel.feel-hot{
      animation: pvFeelHot 900ms cubic-bezier(.2,.8,.2,1) infinite;
    }
    #icFeel.feel-cold{
      animation: pvFeelCold 1200ms cubic-bezier(.2,.8,.2,1) infinite;
    }
    #icFeel.feel-hot-extreme::after,
    #icFeel.feel-cold-extreme::after{
      content:"";
      position:absolute;
      inset:-30%;
      border-radius:999px;
      pointer-events:none;
      opacity:.0;
      transform: rotate(0deg);
      animation: pvFeelSheen 1.1s cubic-bezier(.2,.8,.2,1) infinite;
    }
    #icFeel.feel-hot-extreme::after{
      background: radial-gradient(circle at 35% 35%, rgba(245,158,11,.35) 0%, rgba(245,158,11,0) 55%);
    }
    #icFeel.feel-cold-extreme::after{
      background: radial-gradient(circle at 35% 35%, rgba(59,130,246,.28) 0%, rgba(59,130,246,0) 55%);
    }
    @keyframes pvFeelHot{
      0%,100%{ transform: translateY(0) rotate(0deg) }
      25%{ transform: translateY(-1px) rotate(-1.2deg) }
      50%{ transform: translateY(0) rotate(0.9deg) }
      75%{ transform: translateY(1px) rotate(-0.6deg) }
    }
    @keyframes pvFeelCold{
      0%,100%{ transform: translateX(0) }
      20%{ transform: translateX(-1px) }
      40%{ transform: translateX(1px) }
      60%{ transform: translateX(-1px) }
      80%{ transform: translateX(1px) }
    }
    @keyframes pvFeelSheen{
      0%{ opacity:0; transform: rotate(0deg) scale(.98) }
      35%{ opacity:.9; transform: rotate(18deg) scale(1.02) }
      70%{ opacity:.15; transform: rotate(36deg) scale(1.04) }
      100%{ opacity:0; transform: rotate(52deg) scale(1.02) }
    }
  </style>
</head>

<body>
  <div class="pvFrame">
    <div class="pvCard" id="panel" data-title="PREVISÃO DO TEMPO" data-subtitle="LOCAL • ES">
      <header class="pvHeader">
        <div class="pvLeft">
          <div class="pvBadge" aria-hidden="true" id="hdrIcon"></div>
          <div class="pvTitles">
            <h1 class="pvTitle" id="title"></h1>
            <div class="pvSubtitle" id="subtitle"></div>
          </div>
        </div>
        <div class="pvRight">
          <div class="pvClock" id="pvClock">--:--</div>
        </div>
      </header>

      <div class="pvSubbar">
        <div class="pvSubLeft" id="subLeft">HOJE • PRÓXIMOS DIAS</div>
        <div class="pvSubRight">
          <div class="sourceTag" id="subSource">FONTE • OPEN-METEO</div>

          <div class="alertPill" id="alertTop">
            <span class="alertPulse" aria-hidden="true"></span>
            <span id="alertIcon" aria-hidden="true"></span>
            <span id="alertTopText">ALERTA • —</span>
          </div>
        </div>
      </div>

      <main class="pvMain">
        <div class="layout">
          <!-- ESQUERDA: HOJE -->
          <section class="todayCard">
            <div class="todayHead">
              <div class="city" id="cityName">—</div>
            </div>

            <div class="todayCenter">
              <div class="todayWrap">
                <div class="todayIcon" id="todayIcon" aria-hidden="true"></div>
                <div class="tempBlock">
                  <div class="tempBig" id="tempToday">--<small>°C</small></div>
                  <div class="condLine" id="descToday">CARREGANDO…</div>
                </div>
              </div>
            </div>

            <div class="todayBottom">
              <div class="metricsRow">
                <div class="mCard">
                  <div class="mLeft">
                    <div class="mIcon" aria-hidden="true" id="icFeel"></div>
                    <div class="mLabel">SENSAÇÃO</div>
                  </div>
                  <div class="mVal" id="feels">--°</div>
                </div>

                <div class="mCard">
                  <div class="mLeft">
                    <div class="mIcon" aria-hidden="true" id="icWind"></div>
                    <div class="mLabel">VENTO</div>
                  </div>
                  <div class="mVal" id="wind">-- km/h</div>
                </div>

                <div class="mCard">
                  <div class="mLeft">
                    <div class="mIcon" aria-hidden="true" id="icHum"></div>
                    <div class="mLabel">UMIDADE</div>
                  </div>
                  <div class="mVal" id="humidity">--%</div>
                </div>
              </div>
            </div>
          </section>

          <!-- DIREITA: Alterna -->
          <aside class="side">
            <div class="sideHeader">
              <div class="label" id="sideLabel">PRÓXIMOS DIAS</div>
              <div class="toggleDots" aria-hidden="true">
                <div class="tdot active" id="dotA"></div>
                <div class="tdot" id="dotB"></div>
              </div>
            </div>

            <div class="slot">
              <!-- View A: Próximos dias -->
              <div class="view active" id="viewA">
                <div class="forecastList" id="forecastList"></div>
              </div>

              <!-- View B: Detalhes hoje -->
              <div class="view" id="viewB">
                <div class="detailCard">
                  <div class="bigMinMax">
                    <div class="mmBlock">
                      <div class="mmNum" id="tMax">--°</div>
                      <div class="mmLbl">máx</div>
                    </div>
                    <div class="mmBlock">
                      <div class="mmNum" id="tMin">--°</div>
                      <div class="mmLbl">mín</div>
                    </div>
                  </div>

                  <div class="detailPills">
                    <div class="dPill" id="pillRain"><span id="rainMm">-- mm</span></div>
                    <div class="dPill" id="pillPop"><span id="popPct">--% chuva</span></div>
                    <div class="dPill" id="pillCond"><span id="condTxt">—</span></div>
                  </div>
                </div>
              </div>
            </div>
          </aside>

        </div>
      </main>

      <footer class="pvFooter" aria-label="Rodapé PontoView">
        <div class="pvFooterUpdate" id="footUpdated">ATUALIZADO • —</div>
        <img class="pvLogo" src="./assets/logo-pontoview.png" alt="Logo PontoView" />
      </footer>
    </div>
  </div>

  <script>
    const FALLBACK_CITY = { name: "Vitória - ES", lat: -20.3155, lon: -40.3128, state: "ES" };
    const ROTATE_MS = 11000;          // alterna a view da direita
    const WEATHER_REFRESH_MIN = 25;
    const TZ = "America/Sao_Paulo";

    let CITY = { ...FALLBACK_CITY };
    let dailyData = null;

    function pad2(n){ return String(n).padStart(2,"0"); }
    function hhmm(d=new Date()){ return pad2(d.getHours())+":"+pad2(d.getMinutes()); }
    function ddmm_hhmm(d=new Date()){
      const dd = pad2(d.getDate());
      const mm = pad2(d.getMonth()+1);
      return `${dd}/${mm}, ${hhmm(d)}`;
    }

    const panel = document.getElementById("panel");
    document.getElementById("title").textContent = panel.dataset.title || "PREVISÃO DO TEMPO";
    document.getElementById("subtitle").textContent = panel.dataset.subtitle || "LOCAL • ES";

    function tickClock(){ document.getElementById("pvClock").textContent = hhmm(); }
    tickClock();
    setInterval(tickClock, 1000);

    /* ===== SVGs ===== */
    function svgCloud(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 17.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 10.2 3.8 3.8 0 0 0 7 17.5h13z"/>
      </svg>`; }
    function svgSun(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"></path>
      </svg>`; }
    function svgRain(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h13z"/>
        <path d="M8 19l-1 2"></path>
        <path d="M12 19l-1 2"></path>
        <path d="M16 19l-1 2"></path>
      </svg>`; }
    function svgStorm(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h9"/>
        <path d="M13 14l-2 4h3l-2 4"></path>
      </svg>`; }
    function svgPartly(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="8" cy="8" r="3"></circle>
        <path d="M8 2v1M8 13v1M2 8h1M13 8h1M3.5 3.5l.7.7M11.8 11.8l.7.7M3.5 12.5l.7-.7M11.8 4.2l.7-.7"></path>
        <path d="M20 17.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 8.3 10.1 3.8 3.8 0 0 0 9 17.5h11z"/>
      </svg>`; }
    function svgWind(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 12h11"/>
        <path d="M14 12a3 3 0 1 0-3-3"/>
        <path d="M3 18h15"/>
        <path d="M18 18a3 3 0 1 0-3-3"/>
      </svg>`; }
    function svgDrop(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2s6 7 6 12a6 6 0 0 1-12 0c0-5 6-12 6-12z"/>
      </svg>`; }
    function svgThermo(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 14.76V5a2 2 0 0 0-4 0v9.76a4 4 0 1 0 4 0z"/>
      </svg>`; }
    function svgWarn(){ return `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round">
        <path d="M10.3 3.2 1.8 18a2 2 0 0 0 1.7 3h17a2 2 0 0 0 1.7-3L13.7 3.2a2 2 0 0 0-3.4 0z"/>
        <path d="M12 9v4"/>
        <path d="M12 17h.01"/>
      </svg>`; }

    document.getElementById("hdrIcon").innerHTML = svgCloud();
    document.getElementById("icFeel").innerHTML = svgThermo();
    document.getElementById("icWind").innerHTML = svgWind();
    document.getElementById("icHum").innerHTML = svgDrop();

    function codeToMeta(code){
      if (code === 0) return { icon: svgSun(), text: "Ensolarado", kind:"sun" };
      if (code === 1 || code === 2) return { icon: svgPartly(), text: "Parcialmente nublado", kind:"partly" };
      if (code === 3) return { icon: svgCloud(), text: "Nublado", kind:"cloud" };
      if ([45,48].includes(code)) return { icon: svgCloud(), text: "Neblina", kind:"cloud" };
      if ([51,53,55,61,63,65,80,81,82].includes(code)) return { icon: svgRain(), text: "Chuva", kind:"rain" };
      if ([95,96,99].includes(code)) return { icon: svgStorm(), text: "Tempestade", kind:"storm" };
      return { icon: svgCloud(), text: "Tempo", kind:"cloud" };
    }

    function buildAnimatedTodayIcon(kind){
      if (kind === "rain"){
        return `
          <svg class="animFloat" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h13z"/>
            <path class="animRainDrop" d="M8 19l-1 2"></path>
            <path class="animRainDrop" style="animation-delay:.2s" d="M12 19l-1 2"></path>
            <path class="animRainDrop" style="animation-delay:.4s" d="M16 19l-1 2"></path>
          </svg>
        `;
      }
      if (kind === "storm"){
        return `
          <svg class="animFloat" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 16.5a4.5 4.5 0 0 0-1.3-8.8A6 6 0 0 0 6.2 9.2 3.8 3.8 0 0 0 7 16.5h9"/>
            <path class="animLightning" d="M13 14l-2 4h3l-2 4"></path>
          </svg>
        `;
      }
      if (kind === "sun") return `<div class="animFloat">${svgSun()}</div>`;
      if (kind === "partly") return `<div class="animFloat">${svgPartly()}</div>`;
      return `<div class="animFloat">${svgCloud()}</div>`;
    }

    function dowPT(dateStr){
      const d = new Date(dateStr + "T12:00:00");
      const map = ["DOM","SEG","TER","QUA","QUI","SEX","SÁB"];
      return map[d.getDay()];
    }

    /* ===== ALERTA ===== */
    function getAlertFor(code){
      if ([95,96,99].includes(code)) return { show:true, label:"ALERTA • TEMPESTADE" };
      if ([65,82].includes(code)) return { show:true, label:"ALERTA • CHUVA FORTE" };
      return { show:false, label:"" };
    }

    function setAlert(code){
      const a = getAlertFor(code);
      const top = document.getElementById("alertTop");
      const topText = document.getElementById("alertTopText");
      const icon = document.getElementById("alertIcon");

      if (a.show){
        top.classList.add("show");
        icon.innerHTML = svgWarn();
        topText.textContent = a.label;
      } else {
        top.classList.remove("show");
        icon.innerHTML = "";
        topText.textContent = "ALERTA • —";
      }
    }

    /* ===== SENSAÇÃO: animação só no ícone (icFeel) =====
       Frio: <= 19°C (como você pediu)
       Extremo frio: <= 12°C
       Calor: >= 32°C
       Extremo calor: >= 36°C
    */
    const FEEL_LIMITS = { cold: 19, coldExtreme: 12, hot: 32, hotExtreme: 36 };

    function setFeelIconState(feelsLike){
      const el = document.getElementById("icFeel");
      if(!el || !Number.isFinite(feelsLike)) return;

      el.classList.remove("feel-hot","feel-cold","feel-hot-extreme","feel-cold-extreme");

      if (feelsLike <= FEEL_LIMITS.cold){
        el.classList.add("feel-cold");
        if (feelsLike <= FEEL_LIMITS.coldExtreme) el.classList.add("feel-cold-extreme");
        return;
      }

      if (feelsLike >= FEEL_LIMITS.hot){
        el.classList.add("feel-hot");
        if (feelsLike >= FEEL_LIMITS.hotExtreme) el.classList.add("feel-hot-extreme");
      }
    }

    /* ===== AUTO-SCROLL (loop) ===== */
    let autoScrollTimer = null;
    function startAutoScrollIfNeeded(){
      const list = document.getElementById("forecastList");
      if (!list) return;

      if (autoScrollTimer) {
        clearInterval(autoScrollTimer);
        autoScrollTimer = null;
      }

      setTimeout(()=>{
        const needs = list.scrollHeight > (list.clientHeight + 2);
        if (!needs) { list.scrollTop = 0; return; }

        let direction = 1;
        const speed = 0.35;
        const pauseAtEndsMs = 900;

        autoScrollTimer = setInterval(()=>{
          const maxScroll = list.scrollHeight - list.clientHeight;
          if (maxScroll <= 0) { list.scrollTop = 0; return; }

          list.scrollTop += direction * speed;

          if (list.scrollTop >= maxScroll - 1){
            list.scrollTop = maxScroll;
            direction = -1;
            clearInterval(autoScrollTimer);
            autoScrollTimer = setTimeout(()=>startAutoScrollIfNeeded(), pauseAtEndsMs);
          } else if (list.scrollTop <= 1 && direction === -1){
            list.scrollTop = 0;
            direction = 1;
            clearInterval(autoScrollTimer);
            autoScrollTimer = setTimeout(()=>startAutoScrollIfNeeded(), pauseAtEndsMs);
          }
        }, 18);
      }, 250);
    }

    /* ===== Alternância de views (direita) ===== */
    const viewA = document.getElementById("viewA");
    const viewB = document.getElementById("viewB");
    const dotA = document.getElementById("dotA");
    const dotB = document.getElementById("dotB");
    const sideLabel = document.getElementById("sideLabel");

    let showingA = true;

    function showA(){
      showingA = true;
      viewA.classList.add("active");
      viewB.classList.remove("active");
      dotA.classList.add("active");
      dotB.classList.remove("active");
      sideLabel.textContent = "PRÓXIMOS DIAS";
      startAutoScrollIfNeeded();
    }
    function showB(){
      showingA = false;
      viewB.classList.add("active");
      viewA.classList.remove("active");
      dotB.classList.add("active");
      dotA.classList.remove("active");
      sideLabel.textContent = "DETALHES • HOJE";
    }
    setInterval(()=>{ showingA ? showB() : showA(); }, ROTATE_MS);

    /* ===== RENDER ===== */
    function renderForecastList(){
      const list = document.getElementById("forecastList");
      list.innerHTML = "";
      if(!dailyData) return;

      const { time, weather_code, temperature_2m_max, temperature_2m_min, precipitation_probability_max, precipitation_sum } = dailyData;

      const start = 1;
      const end = Math.min(time.length, 6);

      for(let i=start; i<end; i++){
        const meta = codeToMeta(weather_code[i]);
        const pop = precipitation_probability_max?.[i] ?? 0;
        const mm = (precipitation_sum?.[i] ?? 0);
        const max = Math.round(temperature_2m_max[i]);
        const min = Math.round(temperature_2m_min[i]);

        const row = document.createElement("div");
        row.className = "fRow";
        row.innerHTML = `
          <div class="fDow">${dowPT(time[i])}</div>
          <div class="fIcon" aria-hidden="true">${meta.icon}</div>
          <div class="fMid">
            <div class="fBadge">${meta.text}</div>
            <div class="fSub">${Math.round(mm*10)/10} mm • ${pop}%</div>
          </div>
          <div class="fTemps">
            <span class="pill">
              <span class="pillTag">MÁX</span>
              <span class="pillTemp">${max}°</span>
            </span>
            <span class="pill" style="opacity:.75">
              <span class="pillTag">MÍN</span>
              <span class="pillTemp">${min}°</span>
            </span>
          </div>
        `;
        list.appendChild(row);
      }

      if (showingA) startAutoScrollIfNeeded();
    }

    function renderTodayDetails(){
      if(!dailyData) return;

      const { weather_code, temperature_2m_max, temperature_2m_min, precipitation_probability_max, precipitation_sum } = dailyData;

      const idx = 0;
      const meta = codeToMeta(weather_code[idx]);
      const pop = precipitation_probability_max?.[idx] ?? 0;
      const mm = (precipitation_sum?.[idx] ?? 0);
      const max = Math.round(temperature_2m_max[idx]);
      const min = Math.round(temperature_2m_min[idx]);

      document.getElementById("tMax").textContent = `${max}°`;
      document.getElementById("tMin").textContent = `${min}°`;

      document.getElementById("pillCond").innerHTML = `${meta.icon}<span id="condTxt">${meta.text.toUpperCase()}</span>`;
      document.getElementById("pillRain").innerHTML = `${svgRain()}<span id="rainMm">${Math.round(mm*10)/10} mm</span>`;
      document.getElementById("pillPop").innerHTML = `${svgDrop()}<span id="popPct">${Math.round(pop)}% chuva</span>`;
    }

    async function loadWeather(){
      const url = new URL("https://api.open-meteo.com/v1/forecast");
      url.searchParams.set("latitude", CITY.lat);
      url.searchParams.set("longitude", CITY.lon);
      url.searchParams.set("timezone", TZ);
      url.searchParams.set("current", "temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m");
      url.searchParams.set("daily", "weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max,precipitation_sum");
      url.searchParams.set("forecast_days", "6");

      const res = await fetch(url.toString(), { cache:"no-store" });
      if(!res.ok) throw new Error("Falha ao carregar clima");
      const data = await res.json();

      document.getElementById("cityName").textContent = CITY.name;
      document.getElementById("footUpdated").textContent = `ATUALIZADO • ${ddmm_hhmm()}`;

      const cur = data.current;
      const meta = codeToMeta(cur.weather_code);

      setAlert(cur.weather_code);

      document.getElementById("tempToday").innerHTML = `${Math.round(cur.temperature_2m)}<small>°C</small>`;
      document.getElementById("descToday").textContent = meta.text.toUpperCase();
      document.getElementById("todayIcon").innerHTML = buildAnimatedTodayIcon(meta.kind);

      document.getElementById("feels").textContent = `${Math.round(cur.apparent_temperature)}°`;
      setFeelIconState(cur.apparent_temperature);

      document.getElementById("wind").textContent = `${Math.round(cur.wind_speed_10m)} km/h`;
      document.getElementById("humidity").textContent = `${Math.round(cur.relative_humidity_2m)}%`;

      dailyData = data.daily;
      renderForecastList();
      renderTodayDetails();
    }

    async function resolveCityByIP(){
      const res = await fetch("https://ipapi.co/json/", { cache:"no-store" });
      if(!res.ok) throw new Error("ipapi falhou");
      const j = await res.json();

      const lat = Number(j.latitude);
      const lon = Number(j.longitude);
      const city = (j.city || "").trim();
      const region = (j.region_code || j.region || "").trim();

      if (!Number.isFinite(lat) || !Number.isFinite(lon)) throw new Error("coords inválidas");
      const name = city ? `${city}${region ? " • " + region : ""}` : (region || "LOCAL");

      CITY = { name, lat, lon, state: region || "" };
      const sub = (CITY.state === "ES") ? "LOCAL • ES" : "LOCAL";
      document.getElementById("subtitle").textContent = sub;
    }

    // boot
    showA();
    (async ()=>{
      try{ await resolveCityByIP(); }
      catch(e){
        CITY = { ...FALLBACK_CITY };
        document.getElementById("subtitle").textContent = "LOCAL • ES";
      }

      try{ await loadWeather(); }
      catch(err){
        document.getElementById("descToday").textContent = "SEM CONEXÃO";
        document.getElementById("cityName").textContent = CITY.name || "—";
        document.getElementById("footUpdated").textContent = "ATUALIZADO • —";
        console.error(err);
      }

      setInterval(()=>loadWeather().catch(()=>{}), 1000 * 60 * WEATHER_REFRESH_MIN);
    })();
  </script>
</body>
</html>
